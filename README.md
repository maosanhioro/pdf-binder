# PdfBinder

## 概要
PDFファイルの結合とページ抜き取りを簡単な操作で行えるツールです。
リテラシーが高くない従業員でも直感的に使用できるGUIアプリケーションです。

## 機能

### 🔄 PDF結合
- 複数のPDFファイルを1つのファイルに結合
- ファイルの選択は一覧から複数選択可能
- 出力ファイル名を自由に設定可能

### ✂️ ページ抜き取り
- PDFファイルから指定したページを抜き取って新しいPDFを作成
- 柔軟なページ指定方法をサポート
  - 単一ページ: `1,3,5`
  - 範囲指定: `1-5,8,10-12`
  - 混合指定: `1,3-5,7,9-10`

## インストール・配布

### 🎯 EXEファイル配布（推奨）
1. **Windows環境**で `build_exe_windows.bat` を実行してEXEファイルを作成
2. 作成された `dist/PdfBinder.exe` を配布
3. **受け取った側はPythonのインストール不要**
4. **Windows 11対応・文字化け対策済み**

### 🔧 開発者向け（Windows）
Windows 上での開発・テスト手順（最小）:

```powershell
# 仮想環境の作成（任意）
python -m venv .venv
.\.venv\Scripts\activate

# 必要なライブラリをインストール
pip install PyPDF2 pyinstaller

# GUI を直接実行
python pdfbinder_gui.py

# EXE を作成
.\build_exe_windows.bat
```

### 📦 配布パッケージ
```
📁 配布用フォルダ/
├── 📄 PDF管理ツール.exe        # メインアプリケーション
├── 📄 README.md                # 使い方マニュアル
└── 📄 Windows_Setup_Guide.md   # 開発者向けビルド手順
```

## 使い方

### 1. アプリケーションの起動
- `PdfBinder.exe` をダブルクリック
- アプリケーションが起動します

### 2. 作業フォルダの選択
- 「フォルダ選択」ボタンをクリック
- PDFファイルがあるフォルダを選択
- ファイル一覧が自動更新されます

### 3. PDF結合の実行
1. 「PDF結合を開始」ボタンをクリック
2. 結合したいPDFファイルを選択（複数選択可能）
3. 出力ファイル名を入力
4. 「結合実行」ボタンをクリック

### 4. ページ抜き取りの実行
1. 「ページ抜き取りを開始」ボタンをクリック
2. 対象のPDFファイルを選択
3. 抜き取りたいページ番号を入力
   - 例: `1,3,5-8,10`
4. 出力ファイル名を入力
5. 「抜き取り実行」ボタンをクリック

## ページ指定の例

| 入力例        | 説明                            |
| ------------- | ------------------------------- |
| `1`           | 1ページ目のみ                   |
| `1,3,5`       | 1、3、5ページ目                 |
| `1-5`         | 1ページ目から5ページ目まで      |
| `1-3,7,10-12` | 1-3ページ、7ページ、10-12ページ |

## 注意事項

- PDFファイルは事前に作業フォルダに配置してください
- 出力ファイル名に`.pdf`拡張子は自動で追加されます
- 既存ファイルの上書き時は確認ダイアログが表示されます
- エラーが発生した場合は詳細なメッセージが表示されます

## Windows 11での文字化け対策

本ツールは以下の対策により、Windows 11環境での文字化けを防止しています：

- **システムフォント使用**: Windows標準の「Yu Gothic UI」フォントを使用
- **エンコーディング対応**: UTF-8とShift_JISの自動判別
- **ロケール設定**: 日本語環境の自動設定

## 既存のツール

このプロジェクトはGUIアプリケーション1つに統合されており、直感的な操作でPDFの結合とページ抜き取りが可能です。

## システム要件

- **Windows 11** (推奨・文字化け対策済み)
- **Windows 10** (サポート)
- または Python 3.6以降 + 必要ライブラリ

## トラブルシューティング

### EXEファイルが実行できない
- **Windows Defender対策**: 
  1. 「詳細情報」をクリック
  2. 「実行」ボタンをクリック
  3. 信頼できる場所に移動することを推奨
- **管理者権限**: 右クリック→「管理者として実行」を試す

### 文字が化けて見える
- Windows 11では自動的に対応されます
- Windows 10以前：システムの言語設定を確認
- フォントが正しく表示されない場合：PCの再起動を試す

### PDFファイルが一覧に表示されない
- 作業フォルダが正しく選択されているか確認
- PDFファイルの拡張子が`.pdf`になっているか確認
- 「更新」ボタンをクリックしてリストを更新

### ページ抜き取りでエラーが発生する
- ページ番号が正しい範囲内か確認
- PDFファイルが破損していないか確認
- ページ番号の形式が正しいか確認（例：`1,3-5,7`）

### EXEファイルのビルドができない
- Windows環境で実行しているか確認
- `Windows_Setup_Guide.md` の手順に従ってセットアップ
- Pythonとpyinstallerが正しくインストールされているか確認

## ファイル構成

```
📁 プロジェクトフォルダ/
├── 📄 pdfbinder_gui.py            # GUIアプリケーション本体
├── 📄 build_exe_windows.bat       # Windows用ビルドスクリプト
├── 📄 README.md                   # このファイル
├── 📄 Windows_Setup_Guide.md      # 開発環境セットアップ手順
└── 📁 dist/
    └── 📄 PdfBinder.exe           # 配布用実行ファイル
```

## 技術仕様

- **開発言語**: Python 3.13
- **GUIライブラリ**: tkinter
- **PDFライブラリ**: PyPDF2
- **配布形式**: PyInstaller（単一実行ファイル）
- **文字エンコーディング**: UTF-8 (Windows対応)
-- **対応フォント**: Yu Gothic UI (Windows)

## 更新履歴

- **v1.1.0** - Windows 11対応版・最終版
  - Windows 11での文字化け対策実装
  - EXE拡張子の問題修正
  - フォント設定最適化
  - プロジェクト構成をシンプル化
  - 不要なCLIツールとバッチファイルを削除

- **v1.0.0** - 初回リリース
  - PDF結合機能
  - ページ抜き取り機能
  - GUI版アプリケーション
  - EXE配布パッケージ

---

**開発者**: GitHub Copilot  
**最終更新**: 2025年9月11日  
**対応OS**: Windows 11 (推奨), Windows 10
